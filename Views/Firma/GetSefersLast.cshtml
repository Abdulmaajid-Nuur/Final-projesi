@model (List<Expedition> list,List<Ticket> ticket);
@{
    ViewData["Title"] = "GetSefers";
    Layout = "~/Views/Shared/_FirmaLayout.cshtml";
     
}

<div class="row">
    <div class="col-md-2"></div>
    <div class="col-md-10">
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">


<link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css">
<!-- Tempusdominus Bootstrap 4 -->




        <section class="space-ptb">
            <div class="container">
                <br /><br /><br />

                @if (Model.list.Count == 0)
                {
                    <p>Veri Bulunamadı</p>
                }
                @foreach (var item in Model.list)
                {
                    <div style="background-color: #343a40" class="row">
                        <div class="col-lg-12">
                            <div class="property-item property-col-list mt-4">
                                <div class="row g-0">
                                    <div class="col-lg-2 col-md-2">
                                        <div class="property-image">
                                            <img class="img-fluid" src="~/img/3421-sm.png" style="width: 100%; height: 100px; padding: 10px" alt="">
                                            <div class="property-agent"></div>
                                        </div>
                                    </div>
                                    <div class="col-lg-2 col-md-2"></div>
                                    <div class="col-lg-8 col-md-9">
                                        <div class="property-details">
                                            <div class="property-details-inner">
                                                <ul style="margin-top: 20px" class="property-info list-unstyled d-flex">
                                                    <li class="flex-fill property-clock">
                                                        <i style="margin-right: 5px; margin-left: 28px" class="fas fa-clock"></i>
                                                        <span style="font-weight: bold">@item.KalkisTime.ToString("HH:mm")</span>
                                                        @{
                                                            TimeSpan date = item.VarisTime - item.KalkisTime;
                                                        }
                                                        <span style="display: block"> (@date.Hours Saat @date.Minutes Dakika)</span>
                                                    </li>
                                                    <li class="flex-fill property-chair">
                                                        <i style="margin-right: 5px; margin-left: 70px" class="fas fa-chair"></i>

                                                        @if (item.Plus == true)
                                                        {
                                                            <span>2+2</span>
                                                        }
                                                        else
                                                        {
                                                            <span>2+1</span>
                                                        }

                                                        <span style="display: block">@item.Kalkis Otogarı > @item.Varis Otogarı</span>
                                                    </li>
                                                    <li class="flex-fill property-m-sqft">
                                                        <span style="font-size: 20px; font-weight: bold">@item.Price TL</span>
                                                    </li>
                                                    <li class="flex-fill property-m-sqft">
                                                        <div class="property-btn">
                                                            <a data-bs-toggle="collapse" href="#collapseExample_@item.Id" role="button" aria-expanded="false" aria-controls="collapseExample" class="btn btn-danger" href="property-detail-style-01.html">Koltuk Seç</a>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top:10px" class="collapse" id="collapseExample_@item.Id">
                        <div class="card card-body">
                            @if (item.Plus == true)
                            {
                                <div style="background-color:lightgrey" class="container">
                                    @for (int i = 0; i < 4; i++) // 4 sıra için döngü
                                    {
                                        <div class="row">
                                            @for (int j = 1; j <= 12; j++) // Her sıra için 15 kolon oluştur
                                            {
                                                bool islem = false;
                                                @if (((i * 12) + j) <= 24)
                                                {
                                                    @foreach (var tickets in Model.ticket)
                                                    {
                                                        @if (tickets.ExpeditionId == item.Id && tickets.SeatNo == ((i * 12) + j))
                                                        {
                                                            @if (tickets.Gender == false)
                                                            {
                                                                <div class="col-md-1">
                                                                    <a style="margin:3px;width:40px;height:40px;text-align:center" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal_@(item.Id)_@((i * 12) + j)"><strong>@((i * 12) + j)</strong></a>
                                                                </div>

                                                            }
                                                            else
                                                            {
                                                                <div class="col-md-1">
                                                                    <a style="margin:3px;width:40px;height:40px;text-align:center" class="btn btn-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal_@(item.Id)_@((i * 12) + j)"><strong>@((i * 12) + j)</strong></a>
                                                                </div>

                                                            }
                                                        }
                                                        else
                                                        {
                                                            islem = true;
                                                        }
                                                    }
                                                    if (islem == true)
                                                    {
                                                        <div class="col-md-1">
                                                            <a style="margin:3px;width:40px;height:40px;text-align:center" class="btn btn-light btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal_@(item.Id)_@((i * 12) + j)"><strong>@((i * 12) + j)</strong></a>
                                                        </div>
                                                        islem = false;
                                                    }
                                                }

                                                @if (((i * 12) + j) > 24 && ((i * 12) + j) <= 36)
                                                {
                                                    <div class="col-md-1">
                                                        <a style="margin-top:30px;margin-left:3px;margin-right:3px;margin-bottom:3px;width:40px;height:40px;text-align:center" data-bs-toggle="modal" data-bs-target="#exampleModal_@(item.Id)_@((i * 12) + j)" class="btn btn-light btn-sm"><strong>@((i * 12) + j)</strong></a>
                                                    </div>
                                                }
                                                @if (((i * 12) + j) > 36)
                                                {
                                                    <div class="col-md-1">
                                                        <a style="margin:3px;width:40px;height:40px;text-align:center" class="btn btn-light btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal_@(item.Id)_@((i * 12) + j)"><strong>@((i * 12) + j)</strong></a>
                                                    </div>
                                                }
                                                <div class="modal fade" id="exampleModal_@(item.Id)_@((i * 12) + j)" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLabel">@((i * 12) + j) Koltuk Numarasına Bilet Al</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="tab-content" id="myTabContent">
                                                                    <form asp-controller="Ticket" asp-action="TicketBuy" method="post" class="row mt-4 mb-5 align-items-center">

                                                                        <div class="mb-3 col-sm-12">
                                                                            <input name="Price" type="hidden" class="form-control" placeholder="" value="@item.Price">
                                                                            <input name="SeatNo" type="hidden" class="form-control" placeholder="" value="@((i * 12) + j)">
                                                                            <input name="ExpeditionId" type="hidden" class="form-control" placeholder="" value="@item.Id">
                                                                            @if (User.Identity.IsAuthenticated)
                                                                            {
                                                                                <input name="KullaniciID" type="hidden" class="form-control" placeholder="" value="@ViewBag.userId">
                                                                            }
                                                                            else
                                                                            {
                                                                                <input name="KullaniciID" type="hidden" class="form-control" placeholder="" value="Giriş Yapmamış Kullanici">

                                                                            }
                                                                        </div>

                                                                        <div class="mb-3 col-sm-12">
                                                                            <div class="row">
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">Ad</label>
                                                                                    <input name="Name" type="text" class="form-control" placeholder="" value="">
                                                                                </div>
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">Soyad</label>
                                                                                    <input name="SurName" type="text" class="form-control" placeholder="" value="">
                                                                                </div>
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">Email</label>
                                                                                    <input name="Email" type="text" class="form-control" placeholder="" value="">
                                                                                </div>
                                                                            </div>
                                                                        </div>


                                                                        <div class="mb-3 col-sm-12">
                                                                            <div class="row">
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">Telefon Numarası</label>
                                                                                    <input name="TelNo" type="tel" class="form-control" placeholder="" value="">
                                                                                </div>
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">TC Numarası</label>
                                                                                    <input name="TcNo" type="text" class="form-control" placeholder="" value="">
                                                                                </div>
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">Cinsiyet</label>
                                                                                    <select name="Gender" class="form-control">
                                                                                        <option selected disabled>Cinsiyet Seçiniz</option>
                                                                                        <option value="false">Erkek</option>
                                                                                        <option value="true">Kadın</option>
                                                                                    </select>

                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                        <div class="mb-3 col-sm-12">
                                                                            <div class="row">
                                                                                <h5 class="text-center">Kart İşlemleri</h5>
                                                                                <div class="col-sm-6">
                                                                                    <label class="form-label">İsim Soyisim</label>
                                                                                    <input name="CardName" type="text" class="form-control" placeholder="Kart Adı Soyadı" value="">
                                                                                </div>
                                                                                <div class="col-sm-6">
                                                                                    <label class="form-label">Kart Numarası</label>
                                                                                    <input name="CardNumber" type="text" class="form-control" placeholder="____ ____ ____ ____" value="">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="mb-3 col-sm-12">
                                                                            <div class="row">
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">Ay</label>
                                                                                    <input name="ExpreditionMonth" type="text" class="form-control" placeholder="01" value="">
                                                                                </div>
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">Yıl</label>
                                                                                    <input name="ExpreditionYear" type="text" class="form-control" placeholder="2023" value="">
                                                                                </div>
                                                                                <div class="col-sm-4">
                                                                                    <label class="form-label">CVV</label>
                                                                                    <input name="CVV" type="text" class="form-control" placeholder="***" value="">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-sm-12 d-grid">
                                                                            <input type="submit" class="btn btn-primary" value="Bilet Al">
                                                                        </div>
                                                                    </form>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>

                                            }
                                        </div>
                                    }
                                </div>
                            }
                            else
                            {
                                <div style="background-color:lightgrey" class="container">
                                    @for (int i = 0; i < 4; i++) // 4 sıra için döngü
                                    {
                                        <div class="row">
                                            @for (int j = 1; j <= 12; j++) // Her sıra için 15 kolon oluştur
                                            {
                                                @if (((i * 12) + j) <= 24)
                                                {
                                                    bool islem = false;
                                                    @foreach (var tickets in Model.ticket)
                                                    {
                                                        if (tickets.ExpeditionId == item.Id)
                                                        {
                                                            if (tickets.SeatNo == ((i * 12) + j) && tickets.Gender == false)
                                                            {
                                                                
                                                                <div class="col-md-1">
                                                                    <a style="margin:3px;width:40px;height:40px;text-align:center" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal2_@(item.Id)_@((i * 12) + j)"><strong>@((i * 12) + j)</strong></a>
                                                                </div>
                                                                islem = true;
                                                            }
                                                            else if (tickets.SeatNo == ((i * 12) + j) && tickets.Gender == true)
                                                            {
                                                            

                                                                <div class="col-md-1">
                                                                    <a style="margin:3px;width:40px;height:40px;text-align:center" class="btn btn-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal2_@(item.Id)_@((i * 12) + j)"><strong>@((i * 12) + j)</strong></a>
                                                                </div>
                                                                islem = true;
                                                            }
                                                           
                                                        }
                                                       
                                                    }
                                                    @if (islem == false)
                                                    {
                                                        <div class="col-md-1">
                                                            <a style="margin:3px;width:40px;height:40px;text-align:center" class="btn btn-light btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal_@(item.Id)_@((i * 12) + j)"><strong>@((i * 12) + j)</strong></a>
                                                        </div>
                                                    }

                                                }

                                                @if (((i * 12) + j) > 24 && ((i * 12) + j) <= 36)
                                                {
                                                    <div class="col-md-1">
                                                        <a style="margin-top:30px;margin-left:3px;margin-right:3px;margin-bottom:3px;width:40px;height:40px;text-align:center" data-bs-toggle="modal" data-bs-target="#exampleModal_@(item.Id)_@((i * 12) + j)" class="btn btn-light btn-sm"><strong>@((i * 12) + j)</strong></a>
                                                    </div>
                                                }




                                                <div class="modal fade" id="exampleModal2_@(item.Id)_@((i * 12) + j)" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLabel">@((i * 12) + j)  Numaralı Koltuk Bilgileri</h5>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="tab-content" id="myTabContent">
                                                                    <form asp-controller="Firma" asp-action="UpdateTicket" method="post" class="row mt-4 mb-5 align-items-center">
                                                                        <div class=" col-sm-12">
                                                                               <h5 class="text-center">Yolcu Bilgileri</h5>
                                                                               <br>
                                                                            <input name="Price" type="hidden" class="form-control" placeholder="" value="@item.Price">
                                                                            <input name="SeatNo" type="hidden" class="form-control" placeholder="" value="@((i * 12) + j)">
                                                                            <input name="ExpeditionId" type="hidden" class="form-control" placeholder="" value="@item.Id">
                                                                            @if (User.Identity.IsAuthenticated)
                                                                            {
                                                                                <input name="KullaniciID" type="hidden" class="form-control" placeholder="" value="@ViewBag.userId">
                                                                            }
                                                                            else
                                                                            {
                                                                                <input name="KullaniciID" type="hidden" class="form-control" placeholder="" value="Giriş Yapmamış Kullanici">

                                                                            }
                                                                        </div>

                                                                        @foreach (var bilet in Model.ticket)
                                                                        {
                                                                      

                                                                            @if (bilet.SeatNo == ((i * 12) + j) && bilet.ExpeditionId==item.Id)
                                                                            {
                                                                                <div class="mb-3 col-sm-12">
                                                                                    <div class="row">
                                                                                        <input type="hidden" name="Id" value="@bilet.Id">
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">Ad</label>
                                                                                            <input name="Name" type="text" class="form-control" placeholder="" value="@bilet.Name">
                                                                                        </div>
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">Soyad</label>
                                                                                            <input name="SurName" type="text" class="form-control" placeholder="" value="@bilet.SurName">
                                                                                        </div>
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">Email</label>
                                                                                            <input name="Email" type="text" class="form-control" placeholder="" value="@bilet.Email">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>


                                                                                <div class="mb-3 col-sm-12">
                                                                                    <div class="row">
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">Telefon Numarası</label>
                                                                                            <input name="TelNo" type="tel" class="form-control" placeholder="" value="@bilet.TelNo">
                                                                                        </div>
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">TC Numarası</label>
                                                                                            <input name="TcNo" type="text" class="form-control" placeholder="" value="@bilet.TcNo">
                                                                                        </div>
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">Cinsiyet</label>
                                                                                            <select name="Gender" class="form-control">
                                                                                               @if(bilet.Gender==true)
                                                                                                {
                                                                                                      <option selected value="true">Kadın</option>
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    <option selected value="false">Erkek</option>
                                                                                                }
                                                                                              
                                                                                              
                                                                                            </select>

                                                                                        </div>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="mb-3 col-sm-12">
                                                                                       <br>
                                                                                     <h5 class="text-center">Kart Bilgileri</h5>
                                                                                        <br>
                                                                                    <div class="row">
                                                                                       
                                                                                        <div class="col-sm-6">
                                                                                            <label class="form-label">İsim Soyisim</label>
                                                                                            <input name="CardName" disabled type="text" class="form-control" placeholder="Kart Adı Soyadı" value="@bilet.CardName">
                                                                                        </div>
                                                                                        <div class="col-sm-6">
                                                                                            <label class="form-label">Kart Numarası</label>
                                                                                            <input name="CardNumber" disabled type="text" class="form-control" placeholder="____ ____ ____ ____" value="@bilet.CardNumber">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="mb-3 col-sm-12">
                                                                                    <div class="row">
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">Ay</label>
                                                                                            <input name="ExpreditionMonth" disabled type="text" class="form-control" placeholder="01" value="@bilet.ExpreditionMonth">
                                                                                        </div>
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">Yıl</label>
                                                                                            <input name="ExpreditionYear" disabled type="text" class="form-control" placeholder="2023" value="@bilet.ExpreditionYear">
                                                                                        </div>
                                                                                        <div class="col-sm-4">
                                                                                            <label class="form-label">CVV</label>
                                                                                            <input name="CVV" type="text" disabled class="form-control" placeholder="***" value="@bilet.CVV">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <br />
                                                                                
                                                                      
                                                                            }

                                                        }

                                                                      
                                                                    </form>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                        </div>



                                    }
                                </div>
                            }
                        </div>
                    </div>
                    <br />






                }



                <br />







            </div>

        </section>



        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
    </div>
</div>

