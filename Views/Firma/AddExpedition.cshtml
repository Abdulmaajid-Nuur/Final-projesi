@model Expedition;
@{
    ViewData["Title"] = "AddExpedition";
    Layout = "~/Views/Shared/_FirmaLayout.cshtml";
}

<div class="row">

    <div class="col-md-3"></div>
    <div class="col-md-9">
        <h3 style="text-align:center">Sefer Oluştur</h3>

        <form style="margin-top:100px" asp-action="AddExpedition" asp-controller="Firma" method="post">

            <div class="row container">
                <div class="col-md-6">
                    <label style="font-weight:bold">
                        Kalkış Yeri

                    </label>
                    <select onchange="getDistrict()" class="form-control" name="Kalkis" required>
                        <option selected disabled>Seçiniz</option>

                        @foreach (var item in ViewBag.cities)
                        {
                            <option value="@item.Name">@item.Name</option>
                        }
                    </select>
                </div>
                <div class="col-md-6">
                    <label style="font-weight:bold">Varış Yeri</label>
                    <select onchange="getDistrict()" class="form-control" name="Varis" required>
                        <option selected disabled>Seçiniz</option>

                        @foreach (var item in ViewBag.cities)
                        {
                            <option value="@item.Name">@item.Name</option>
                        }
                    </select>
                </div>
            </div>
            <br />
            <div class="row container">
                <div class="col-md-6 ">
                    <label style="font-weight:bold">Kalkış Saati Seçiniz</label>
                    <input name="KalkisTime" class="form-control" type="datetime-local" required />
                </div>
                <div class="col-md-6">
                    <label style="font-weight:bold">Varış Saati Seçiniz</label>
                    <input name="VarisTime" class="form-control" type="datetime-local" required />
                </div>
            </div>
            <br />
            <div class="row container">
                <div class="col-md-6 ">
                    <label style="font-weight:bold">Fiyat</label>
                    <input class="form-control" name="Price" type="number" required />
                </div>
                <div class="col-md-6">
                    <label style="font-weight:bold">2+2 Mi ? </label>
                    <select name="Plus" class="form-control" required>
                        <option>Evet</option>
                        <option>Hayır</option>
                    </select>
                </div>
            </div>
            <br />
            <button class="btn btn-primary container" type="submit">Oluştur</button>

        </form>
    </div>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    function getDistrict() {
        var selectedCityId = $("select[name='city']").val();

        $.ajax({
            url: '/Expedition/GetDistrict',
            type: 'GET',
            data: { cityId: selectedCityId },
            success: function (data) {
                console.log(data);

                var districtSelect = $("#districtSelect");
                districtSelect.empty();
                $.each(data, function (index, district) {
                    districtSelect.append('<option value="' + district.id + '">' + district.name + '</option>');
                });
            },
            error: function (xhr, status, error) {
                console.error('AJAX isteği başarısız: ' + status);
            }
        });
    }
</script>




